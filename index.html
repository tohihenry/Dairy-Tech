<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="https://res.cloudinary.com/dmmpujcvs/image/upload/v1759395722/553061243_802554465499181_1929408745302545088_n_pio0wz.jpg" type="image/jpeg">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dairy Technology - Password Protected</title>
    <style>
        /* Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Login Screen */
        .login-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .login-box {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 500px;
        }
        
        .logo {
            width: 120px;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .password-input {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            width: 100%;
        }
        
        .login-button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .login-button:hover {
            background-color: #2980b9;
        }
        
        .error-message {
            color: #e74c3c;
            margin-top: 10px;
            display: none;
        }
        
        /* Content Styles */
        .content {
            display: none;
        }
        
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px 0;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo-small {
            height: 50px;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
        }
        
        .hero {
            background: linear-gradient(rgba(44, 62, 80, 0.7), rgba(44, 62, 80, 0.7)), url('https://images.unsplash.com/photo-1595475207225-428b62bda831?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2000&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0;
            text-align: center;
        }
        
        .hero h2 {
            font-size: 36px;
            margin-bottom: 20px;
        }
        
        .hero p {
            font-size: 18px;
            max-width: 800px;
            margin: 0 auto 30px;
        }
        
        .metrics-box {
            background-color: rgba(52, 152, 219, 0.9);
            border-radius: 10px;
            padding: 30px;
            margin: 30px auto;
            max-width: 800px;
        }
        
        .metrics-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: white;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .metric-item {
            text-align: center;
        }
        
        .metric-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .section {
            padding: 60px 0;
        }
        
        .section-title {
            font-size: 32px;
            text-align: center;
            margin-bottom: 40px;
            color: #2c3e50;
        }
        
        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .card-header {
            background-color: #3498db;
            color: white;
            padding: 15px 20px;
        }
        
        .card-title {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .card-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .card-spec {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .card-spec:last-child {
            border-bottom: none;
        }
        
        .spec-label {
            font-weight: 500;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
        }
        
        .comparison-table th, .comparison-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .comparison-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .comparison-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .advantage {
            color: #27ae60;
        }
        
        .footer {
            background-color: #2c3e50;
            color: white;
            padding: 40px 0;
            text-align: center;
        }
        
        .footer-content {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .footer h3 {
            margin-bottom: 20px;
        }
        
        .contact-info {
            margin-bottom: 20px;
        }
        
        .contact-info p {
            margin-bottom: 10px;
        }
        
        .social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-link {
            display: inline-block;
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
        }
        
        .social-link:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            border-bottom-color: #3498db;
            color: #3498db;
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .feature-item {
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: center;
        }
        
        .feature-icon {
            font-size: 36px;
            color: #3498db;
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .feature-description {
            font-size: 14px;
            color: #7f8c8d;
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }
            
            nav ul {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            .hero {
                padding: 60px 0;
            }
            
            .hero h2 {
                font-size: 28px;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .section-title {
                font-size: 28px;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
        }
        
        /* Environmental Badge */
        .env-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #27ae60;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .env-badge i {
            font-size: 14px;
        }
    
/* Accessibility and Header additions */
.site-header{
  position: sticky; top: 0; z-index: 50;
  background: rgba(255,255,255,0.9);
  backdrop-filter: saturate(130%) blur(6px);
  border-bottom: 1px solid #e6e6e6;
}
.brand{
  margin: 0 auto; max-width: 1100px;
  display: flex; align-items: center; gap: 16px;
  padding: 10px 16px;
}
.brand-text h1{ margin: 0; font-size: 1.4rem; }
.brand-text .tagline{ margin: 2px 0 0; color: #555; }
@media (prefers-color-scheme: dark){
  .site-header{ background: rgba(18,18,18,0.9); border-bottom-color:#2a2a2a; }
  .brand-text .tagline{ color:#bbb; }
}

.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0;}
.error-message[hidden]{display:none;}
:focus{outline:2px solid #3498db; outline-offset:2px;}
@media (prefers-reduced-motion: reduce){
  *{animation-duration:0.001ms !important; animation-iteration-count:1 !important; transition-duration:0.001ms !important; scroll-behavior:auto !important;}
}

.login-brand{
  display:flex; flex-direction:column; align-items:center; gap:10px;
  margin-bottom: 12px;
}
.login-brand h2{ margin:0; font-weight:600; }

    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <link rel="preload" as="image" href="https://res.cloudinary.com/dmmpujcvs/image/upload/v1759395722/553061243_802554465499181_1929408745302545088_n_pio0wz.jpg">
</head>
<body>
<!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
<div class="login-brand">
  <img
    src="https://res.cloudinary.com/dmmpujcvs/image/upload/v1759395722/553061243_802554465499181_1929408745302545088_n_pio0wz.jpg"
    alt="Dairy Tech logo"
    width="120"
    height="120"
    decoding="async"
    style="aspect-ratio:1/1; object-fit:cover; border-radius:12px;"
  />
  <h2>Private preview</h2>
</div>
<form id="loginForm" class="login-form" novalidate>
  <label for="passwordInput" class="sr-only">Password</label>
  <input type="password" id="passwordInput" class="password-input" placeholder="Enter password" autocomplete="current-password" aria-describedby="errorMessage">
  <button type="submit" class="login-button">Access Content</button>
  <p id="errorMessage" class="error-message" role="alert" aria-live="assertive" hidden>Incorrect password. Please try again.</p>
</form>
</div>
        </div>
    </div>

    <!-- Main Content (Hidden until password is entered) -->
    <div id="content" class="content">
        <header>
            <div class="container">
                <div class="header-content">
                    <img src="https://res.cloudinary.com/dmmpujcvs/image/upload/v1759395722/553061243_802554465499181_1929408745302545088_n_pio0wz.jpg" 
  alt="Dairy Tech Logo" 
  class="logo-small"
  style="height:50px; width:auto; border-radius:6px; object-fit:cover;"
/>

                    <nav>
                        <ul>
                            <li><a href="#technology">Technology</a></li>
                            <li><a href="#products">Products</a></li>
                            <li><a href="#benefits">Benefits</a></li>
                            <li><a href="#comparison">Comparison</a></li>
                            <li><a href="#contact">Contact</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>

        <section class="hero">
            <div class="container">
                <div class="env-badge">
                    <i class="fas fa-leaf"></i> Environmental Innovation
                </div>
                <h2>Modular Disc Stack Dryer Technology</h2>
                <p>Revolutionary dairy waste processing technology that converts waste milk into valuable powder with unprecedented efficiency and modularity.</p>
                
                <div class="metrics-box">
                    <h3 class="metrics-title">Key Metrics</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-value">NZD $2.2B+</div>
                            <div class="metric-label">Market Opportunity</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">407M L</div>
                            <div class="metric-label">Waste Milk Diverted</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">2.45M</div>
                            <div class="metric-label">CO₂ Reduction (tonnes)</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">897%</div>
                            <div class="metric-label">ROI over 5 years</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="technology" class="section">
            <div class="container">
                <h2 class="section-title">Technology Overview</h2>
                
                <div class="tabs">
                    <button class="tab active" onclick="openTab(event, 'core-tech')"" aria-selected="false">Core Technology</button>
                    <div class="tab" onclick="openTab(event, 'product-family')">Product Family</div>
                    <div class="tab" onclick="openTab(event, 'benefits')">Benefits</div>
                    <div class="tab" onclick="openTab(event, 'comparison')">Comparison</div>
                </div>
                
                <div id="core-tech" class="tab-content active">
                    <p style="text-align: center; margin-bottom: 30px;">Our modular disc stack architecture delivers 4-14x capacity increase while reducing power consumption by 50-60%.</p>
                    
                    <div class="feature-grid">
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-cubes"></i></div>
                            <h3 class="feature-title">Modular Architecture</h3>
                            <p class="feature-description">Scalable configurations from 2-10 discs to match any farm size or production need.</p>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-fire"></i></div>
                            <h3 class="feature-title">Hybrid Heating System</h3>
                            <p class="feature-description">Thermal oil primary with infrared secondary for optimal energy efficiency.</p>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-tint"></i></div>
                            <h3 class="feature-title">Precision Spray Application</h3>
                            <p class="feature-description">Cascading feed system with flat fan nozzles for optimal milk film formation.</p>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-feather"></i></div>
                            <h3 class="feature-title">Lightweight Construction</h3>
                            <p class="feature-description">Aluminum 6061-T6 extrusion frame with 65% weight reduction vs steel.</p>
                        </div>
                    </div>
                </div>
                
                <div id="product-family" class="tab-content">
                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">2-Disc System</h3>
                                <div class="card-subtitle">Individual Farm Solution</div>
                            </div>
                            <div class="card-body">
                                <div class="card-spec">
                                    <span class="spec-label">Daily Capacity:</span>
                                    <span>250-300 L/day</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Power Consumption:</span>
                                    <span>18 kW</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Dimensions:</span>
                                    <span>1,200mm × 1,200mm × 1,800mm</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Weight:</span>
                                    <span>480 kg</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Powder Output:</span>
                                    <span>31-37.5 kg/day</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">5-Disc System</h3>
                                <div class="card-subtitle">Farm Partnership Solution</div>
                            </div>
                            <div class="card-body">
                                <div class="card-spec">
                                    <span class="spec-label">Daily Capacity:</span>
                                    <span>625-750 L/day</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Power Consumption:</span>
                                    <span>45 kW</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Dimensions:</span>
                                    <span>3,000mm × 1,200mm × 1,800mm</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Weight:</span>
                                    <span>1,200 kg</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Powder Output:</span>
                                    <span>78-94 kg/day</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">10-Disc System</h3>
                                <div class="card-subtitle">Regional Hub Solution</div>
                            </div>
                            <div class="card-body">
                                <div class="card-spec">
                                    <span class="spec-label">Daily Capacity:</span>
                                    <span>1,250-1,500 L/day</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Power Consumption:</span>
                                    <span>90 kW</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Dimensions:</span>
                                    <span>6,000mm × 1,200mm × 1,800mm</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Weight:</span>
                                    <span>2,400 kg</span>
                                </div>
                                <div class="card-spec">
                                    <span class="spec-label">Powder Output:</span>
                                    <span>156-188 kg/day</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="benefits" class="tab-content">
                    <div class="feature-grid">
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-recycle"></i></div>
                            <h3 class="feature-title">Waste Reduction</h3>
                            <p class="feature-description">Convert waste milk into valuable powder instead of disposal.</p>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-dollar-sign"></i></div>
                            <h3 class="feature-title">Revenue Generation</h3>
                            <p class="feature-description">Create new income stream from previously discarded product.</p>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-leaf"></i></div>
                            <h3 class="feature-title">Environmental Impact</h3>
                            <p class="feature-description">Reduce carbon footprint and water pollution from dairy waste.</p>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-bolt"></i></div>
                            <h3 class="feature-title">Energy Efficiency</h3>
                            <p class="feature-description">50-60% power reduction compared to traditional systems.</p>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-expand-arrows-alt"></i></div>
                            <h3 class="feature-title">Scalability</h3>
                            <p class="feature-description">Start small and expand with modular design as needs grow.</p>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon"><i class="fas fa-tools"></i></div>
                            <h3 class="feature-title">Easy Maintenance</h3>
                            <p class="feature-description">Modular components for simple servicing and replacement.</p>
                        </div>
                    </div>
                </div>
                
                <div id="comparison" class="tab-content">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Feature</th>
                                <th>Traditional Drum Dryer</th>
                                <th>Modular Disc Stack</th>
                                <th>Advantage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Surface Area</td>
                                <td>2.51 m²</td>
                                <td>10.08 m² (2-disc)</td>
                                <td class="advantage">+302%</td>
                            </tr>
                            <tr>
                                <td>Power Consumption</td>
                                <td>43 kW</td>
                                <td>18 kW (2-disc)</td>
                                <td class="advantage">-58%</td>
                            </tr>
                            <tr>
                                <td>Weight</td>
                                <td>1,400 kg</td>
                                <td>480 kg (2-disc)</td>
                                <td class="advantage">-65%</td>
                            </tr>
                            <tr>
                                <td>Footprint</td>
                                <td>4.2 m²</td>
                                <td>1.44 m² (2-disc)</td>
                                <td class="advantage">-66%</td>
                            </tr>
                            <tr>
                                <td>Scalability</td>
                                <td>Fixed capacity</td>
                                <td>Modular expansion</td>
                                <td class="advantage">Superior</td>
                            </tr>
                            <tr>
                                <td>Mobility</td>
                                <td>Fixed installation</td>
                                <td>Trailer-mounted option</td>
                                <td class="advantage">Superior</td>
                            </tr>
                            <tr>
                                <td>Surface Utilization</td>
                                <td>65%</td>
                                <td>94%</td>
                                <td class="advantage">+45%</td>
                            </tr>
                            <tr>
                                <td>Operating RPM</td>
                                <td>15-25</td>
                                <td>60-100</td>
                                <td class="advantage">4-6x faster</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <footer id="contact" class="footer">
            <div class="container">
                <div class="footer-content">
                    <h3>Contact Us</h3>
                    <div class="contact-info">
                        <p>For more information about this revolutionary dairy technology, please contact our team.</p>
                        <p>Email: <a href="mailto:info@dairytech.co.nz">info@dairytech.co.nz</a></p>
                        <p>Phone: <a href="tel:+6491234567">+64 9 123 4567</a></p>
                    </div>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    

<script>
  // SHA-256 helper
  async function sha256(text){
    const enc = new TextEncoder().encode(text);
    const buf = await crypto.subtle.digest('SHA-256', enc);
    return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
  }
  // Precomputed SHA-256 of the current password (change to your own and update this hash)
  const PASSWORD_HASH = '7a032396bf12e1907fce79644df017015bd84d220a4dc12db22f2b961fd0b194';

  const loginScreen = document.getElementById('loginScreen');
  const content = document.getElementById('content');
  const form = document.getElementById('loginForm');
  const input = document.getElementById('passwordInput');
  const err = document.getElementById('errorMessage');

  if(form){
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const hash = await sha256(input.value);
      if(hash === PASSWORD_HASH){
        loginScreen.style.display = 'none';
        content.style.display = 'block';
        document.title = 'Dairy Technology - Modular Disc Stack Dryer';
        content.setAttribute('tabindex','-1');
        content.focus();
      }else{
        err.hidden = false;
        setTimeout(()=> err.hidden = true, 3000);
      }
    });
  }

  // Tabs: ARIA roles and keyboard controls
  const tablist = document.querySelector('.tabs');
  if(tablist){
    tablist.setAttribute('role','tablist');
    tablist.setAttribute('aria-label','Technology sections');
  }
  const tabs = Array.from(document.querySelectorAll('.tab'));
  const panels = Array.from(document.querySelectorAll('.tab-content'));
  // Convert tabs to buttons with roles if not already
  tabs.forEach((t, idx)=>{
    t.setAttribute('role','tab');
    t.id = t.id || ('tab-' + idx);
    const controls = t.getAttribute('data-controls');
    if(controls) t.setAttribute('aria-controls', controls);
    t.setAttribute('tabindex','0');
    t.setAttribute('aria-selected', t.classList.contains('active') ? 'true':'false');
  });
  panels.forEach((p)=>{
    p.setAttribute('role','tabpanel');
    const labelled = document.querySelector('[aria-controls="'+p.id+'"]');
    if(labelled) p.setAttribute('aria-labelledby', labelled.id);
    p.setAttribute('tabindex','0');
  });

  function activateTab(tab){
    tabs.forEach(t=>{
      const selected = (t === tab);
      t.classList.toggle('active', selected);
      t.setAttribute('aria-selected', selected ? 'true':'false');
    });
    panels.forEach(p=>p.classList.remove('active'));
    const panelId = tab.getAttribute('aria-controls');
    if(panelId) document.getElementById(panelId).classList.add('active');
    const panel = document.getElementById(panelId);
    if(panel) panel.focus();
  }

  tabs.forEach(t=>{
    // map existing onclick openTab to aria-controls
    const match = t.getAttribute('onclick');
    if(match){
      const m = match.match(/openTab\(event,\s*'([^']+)'\)/);
      if(m) t.setAttribute('data-controls', m[1]);
      t.removeAttribute('onclick');
    }
    // ensure aria-controls from data-controls
    const controls = t.getAttribute('data-controls');
    if(controls) t.setAttribute('aria-controls', controls);

    t.addEventListener('click', ()=> activateTab(t));
    t.addEventListener('keydown', e=>{
      const i = tabs.indexOf(t);
      if(e.key === 'ArrowRight') { e.preventDefault(); activateTab(tabs[(i+1)%tabs.length]); }
      if(e.key === 'ArrowLeft')  { e.preventDefault(); activateTab(tabs[(i-1+tabs.length)%tabs.length]); }
      if(e.key === 'Home')       { e.preventDefault(); activateTab(tabs[0]); }
      if(e.key === 'End')        { e.preventDefault(); activateTab(tabs[tabs.length-1]); }
      if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); activateTab(t); }
    });
  });
</script>
</body>
</html>
